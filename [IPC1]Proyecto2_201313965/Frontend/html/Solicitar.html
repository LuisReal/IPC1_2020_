<html>

<head>

    <link href="../css/Solicitar.css" rel="stylesheet">
    <link href="../css/navbar.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body onload="mostrarCliente(), mostrarCanciones()">
    <div class="global-container">

        <button id="btn-open-menu" class="btn-open-navbar"><i class="bi bi-list"></i></button>

        <div class="banner-izquierdo" id="banner-izquierdo">
            <button id="btn-close-menu" class="btn-close-navbar"><i class="bi bi-x-square"></i></button>

            <label class="foto-perfil"></label>
            <h1 id="nombre-usuario" class="nombre-usuario"></h1>

            <div class="botones-container">
                <button onclick="backPrincipal()" type="button" class="btn-pagina-principal">Pagina Principal</button>
                <button onclick="miPerfil()" type="button" class="btn-mi-perfil">Mi Perfil</button>
                <button onclick="miPlayList()" type="button" id="playlist" onclick=""
                    class="btn-playlist">MiPlayList</button>
                <button onclick="back()" type="button" class="boton-back">Back</button>
            </div>


        </div>

        <div class="info-container">

            <div class="datos-usuario">
                <p class="p-solicitar">Solicitar Cancion</p>

                <label class="label-nombre">Nombre</label>
                <input class="input-nombre" id="nombre">

                <label class="label-artista">Artista</label>
                <input class="input-artista" id="artista">

                <label class="label-album">Album</label>
                <input class="input-album" id="album">

                <label class="label-fecha">Fecha</label>
                <input class="input-fecha" id="fecha">

                <label class="label-imagen">Imagen</label>
                <input class="input-imagen" id="imagen">

                <label class="label-spotify">Spotify</label>
                <input class="input-spotify" id="spotify">

                <label class="label-youtube">Youtube</label>
                <input class="input-youtube" id="youtube">


                <button type="button" onclick="Solicitar()" class="boton-solicitar">Solicitar</button>
            </div>

        </div>

    </div>


    <script>
        function back() {
            location.href = "Cliente.html"
        }

        function backPrincipal() {
            location.href = "Cliente.html"
        }

        function miPerfil() {
            location.href = "ModificarPerfilCliente.html"
        }

        function miPlayList() {
            location.href = "PlayList.html"
        }

        function mostrarCliente() {
            fetch('http://3.129.19.112:8000/Usuarios',

            ).then(response => response.json()
            ).catch(err => {
                console.log("no se pudo consumir la api")
            }).then(res => {
                console.log(res)
                for (i = 0; i < (res.length); i++) {
                    console.log(res[i])
                    var valor = sessionStorage.usuario // proviene de inicio.html (valor=username)
                    if (res[i].Usuario == valor) {
                        var h1 = document.querySelector('#nombre-usuario')
                        h1.innerHTML +=
                            `

                        <h1>${valor}</h1>
                        `
                    }
                }
            })
        }



        function Solicitar() {


            var nombre = document.querySelector('#nombre').value
            var artista = document.querySelector('#artista').value
            var album = document.querySelector('#album').value
            var fecha = document.querySelector('#fecha').value
            var imagen = document.querySelector('#imagen').value
            var spotify = document.querySelector('#spotify').value
            var youtube = document.querySelector('#youtube').value
            var objeto = {
                'nombre': nombre,
                'artista': artista,
                'album': album,
                'fecha': fecha,
                'imagen': imagen,
                'spotify': spotify,
                'youtube': youtube
            }

            fetch('http://3.129.19.112:8000/Solicitud', {


                method: 'POST',
                body: JSON.stringify(objeto),
                headers: {
                    'Content-Type': 'application/json'
                }
            }).then(response => response.json()
            ).catch(err => {
                console.log("no se pudo consumir la api")
            }).then(res => {
                console.log(res.message)

                alert(res.reason)
                document.location.reload();

            })

        }

    </script>
    <script>
        const open_menu = document.getElementById("btn-open-menu");
        const close_menu = document.getElementById("btn-close-menu");
        const navbar = document.getElementById("banner-izquierdo");


        open_menu.addEventListener("click", () => {
            console.log("hiciste click en abrir menu");
            navbar.classList.add("visible");
        });

        close_menu.addEventListener("click", () => {
            console.log("hiciste click en cerrar menu");
            navbar.classList.remove("visible");
        });

    </script>
</body>

</html>